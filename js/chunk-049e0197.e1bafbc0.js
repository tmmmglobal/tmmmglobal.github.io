(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-049e0197"],{"3e4a":function(e,t,n){},"827f":function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("grade-box",{attrs:{title:e.$t("supernode"),origin:e.origin,supernode:e.supernode}},[n("div",{staticClass:"supernode"},[n("div",{staticClass:"title"},[n("span",[e._v(e._s(e.$t("supernode")))]),n("p",[e._v(e._s(e.bought)),n("span",[e._v("/33")])])]),n("div",{staticClass:"text"},[n("p",[e._v(e._s(e.$t("zunxiang"))+" "),n("span",[e._v("M3"+e._s(e.$t("level")))])]),n("p",[e._v(e._s(e.$t("peisong"))+" "),n("span",[e._v(e._s(e.nodeToken)+" MPC")])]),n("p",[e._v(e._s(e.$t("zhengsong"))+" "),n("span",[e._v("10个M1+5个M2")])]),n("p",[e._v(e._s(e.$t("fenhong"))+" "),n("span",[e._v("1个")])])]),n("Button",{attrs:{disabled:e.supernode>=6,color:"linear-gradient(41deg, #F5D755, #FFA271)"},on:{click:e.buyNode}},[e._v(e._s(e.$t("liji"))+e._s(e.nodePrice)+" USDT")])],1),n("authorization",{attrs:{tokenType:"USDT",show:e.authorizedAccess,click:e.authorizedAccessFun,needAuthorization:e.nodePrice,authorizationEnds:e.authorizationEnds},on:{authorizationEnds:e.end}})],1)},r=[],a=(n("a9e3"),n("d3b7"),n("25f0"),n("3835")),o=(n("96cf"),n("1da1")),i=(n("e7e5"),n("d399")),c=(n("66b9"),n("b650")),d={name:"supernode",components:{Button:c["a"],"grade-box":function(){return n.e("chunk-555ae6bd").then(n.bind(null,"9785"))},authorization:function(){return Promise.resolve().then(n.bind(null,"5326"))}},data:function(){return{origin:0,nodePrice:0,nodeToken:0,usdt:"0",authorizedAccess:!1,authorizationEnds:!1,USDTAuthorizedAccess:"",supernode:0,bought:0}},methods:{buyNode:function(){var e=this;return Number(this.usdt)<Number(this.nodePrice)?i["a"].fail(this.$t("InsufficientBalance")):Number(this.USDTAuthorizedAccess)<Number(this.nodePrice)?this.authorizedAccess=!0:(i["a"].loading({message:"正在交易中...",forbidClick:!0,duration:0}),void this.$tronWeb.call({contractAddress:this.$contracts.Manager.address,method:"paymentSuperNode()"}).then(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$contracts.Manager.paymentSuperNode().send({feeLimit:"50".toSun()}).then((function(t){sessionStorage.setItem("transactionHex",t);var n=setInterval((function(){window.tronWeb.trx.getTransaction(t).then((function(t){t.ret&&"SUCCESS"===t.ret[0].contractRet&&(sessionStorage.removeItem("transactionHex"),clearInterval(n),i["a"].clear(),e.App_Push("/setting"))}))}),2e3)}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){i["a"].clear(),console.log(e)})))},authorizedAccessFun:function(){var e=this;i["a"].loading({message:"正在交易中...",forbidClick:!0,duration:0}),this.$contracts.ERC20Token.approve(this.$contracts.Manager.address,this.nodePrice.toSun()).send({feeLimit:"50".toSun()}).then((function(t){sessionStorage.setItem("transactionHex",t);var n=setInterval((function(){window.tronWeb.trx.getTransaction(t).then((function(t){t.ret&&"SUCCESS"===t.ret[0].contractRet&&(sessionStorage.removeItem("transactionHex"),clearInterval(n),e.$tronWeb.call({contractAddress:e.$contracts.ERC20Token.address,method:"allowance(address,address)",parameter:[{type:"address",value:e.$address},{type:"address",value:e.$contracts.Manager.address}]}).then((function(t){i["a"].clear(),e.authorizedAccess=!1,e.authorizationEnds=!0,e.USDTAuthorizedAccess=t.constant_result[0].decode(["uint256"]).toString().fromSun(),e.buyNode()})))}))}),2e3)})).catch((function(e){i["a"].clear(),console.log(e)}))},end:function(){this.authorizedAccess=!1},init:function(){var e=this;this.$tronWeb.call({contractAddress:this.$contracts.Manager.address,method:"purchasedMapping(address)",parameter:[{type:"address",value:this.$address}]}).then((function(t){var n=t.constant_result[0].decode(["uint256","uint256","uint256"],["levelNum","price","sentToken"]),s=n.levelNum;e.supernode=s.toNumber()})),this.$tronWeb.call({contractAddress:this.$contracts.Relations.address,method:"levelOf(address)",parameter:[{type:"address",value:this.$address}]}).then((function(t){var n=t.constant_result[0].decode(["uint256"]);e.origin=n.toNumber()})),this.$tronWeb.call({contractAddress:this.$contracts.Manager.address,method:"goodsMapping(uint256)",parameter:[{type:"uint256",value:6}]}).then((function(t){var n=t.constant_result[0].decode(["uint256","uint256","uint256"],["levelNum","price","sentToken"]),s=n.price,r=n.sentToken;e.nodePrice=s.toString().fromSun(),e.nodeToken=r.toString().fromSun()})),this.$tronWeb.call({contractAddress:this.$contracts.ERC20Token.address,method:"balanceOf(address)",parameter:[{type:"address",value:this.$address}]}).then((function(t){var n=t.constant_result[0].decode(["uint256"]);e.usdt=n.toString().fromSun()})),this.$tronWeb.call({contractAddress:this.$contracts.ERC20Token.address,method:"allowance(address,address)",parameter:[{type:"address",value:this.$address},{type:"address",value:this.$contracts.Manager.address}]}).then((function(t){var n=t.constant_result[0].decode(["uint256"]);e.USDTAuthorizedAccess=n.toString().fromSun()})),this.$tronWeb.call({contractAddress:this.$contracts.Manager.address,method:"stockInfoList()"}).then((function(t){var n=t.constant_result[0].decode(["uint256[]"]),s=Object(a["a"])(n,4),r=s[3];e.bought=r.toString()}))}},created:function(){this.$tronWeb&&this.init()}},u=d,h=(n("c4b9"),n("2877")),l=Object(h["a"])(u,s,r,!1,null,"0486840f",null);t["default"]=l.exports},c4b9:function(e,t,n){"use strict";var s=n("3e4a"),r=n.n(s);r.a}}]);
//# sourceMappingURL=chunk-049e0197.e1bafbc0.js.map